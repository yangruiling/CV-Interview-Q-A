# 六、机器学习基本算法，如分类、回归、聚类、概率模型

 <https://github.com/GYee/CV_interviews_Q-A>

![descript](media/584c7cbd8706b0526e891a197ec13317.png)

## 归一化和标准化的区别：

归一化：(x-min)/(max-min)，保留了数据中的权重信息

标准化：（x-均值)/方差，保留了数据中的距离信息，丢失了权重信息

## 最小二乘参数估计的具体流程

## 最小乘法和极大似然估计的联系

## 为什么要引入正则化

## 加入正则化项的最小二乘参数估计和最大后验估计的关系

## 极大似然估计与最大后验估计的计算（手写公式）

## 从适用任务、模型、基本思想、损失函数、求解算法讲述以下模型：

|                                                                                  | 任务                                                                                                                 | 模型                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | 基本思想                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 损失函数                                                                                                                                                                                                                                    | 求解算法                                                                                                                            | 概率图                                                                                                         |
|----------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------|
| 感知机                                                                           | 硬二分类                                                                                                             | ![descript](media/d699d4f5948d724b761b7357a998cfbd.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 最小化被错误分类的样本数                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | ![descript](media/d73bf5cd3088427616da2ead8dc5c5cc.png) ![descript](media/80d5f5b4d92e807cb53dfcdebaa4f1be.png)                                                                                                                             | SGD                                                                                                                                 |                                                                                                                |
| 线性判别分析                                                                     | 硬二分类                                                                                                             | ![descript](media/d699d4f5948d724b761b7357a998cfbd.png) 寻找分类超平面                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 样本集**类内样本**在超平面上的**投影方差足够小；类间样本投影的距离足够大**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            | ![descript](media/8acfb672ea36ef55d46b5b61b8f1196a.png) ![descript](media/a271b7bfb20c10dd9aab1c634c4bff24.png) 投影方向上均值差的平方/协方差矩阵之和                                                                                       | 令损失函数导数为0求w                                                                                                                |                                                                                                                |
| 逻辑回归                                                                         | 软二分类                                                                                                             | ![descript](media/b975a38777cb13eef63037d719166527.png) ![descript](media/4fc0d1668307caef042d37bc68d0c884.png) ![descript](media/b9e3f8b81715c013b819f30fe85f7c38.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 线性回归外套激活函数+指定分类阈值                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 极大似然估计 = 最小化交叉熵损失 ![descript](media/8a4882b695d31ab29a44d9ff53e9d569.png)                                                                                                                                                     | 令导数为，求解W                                                                                                                     |                                                                                                                |
| 高斯判别分析                                                                     | 软二分类                                                                                                             | 假设：y服从伯努利分布(0-1分布)，x\|y=1和x\|y=0服从均值不同方差相同的高斯分布 ![descript](media/7a48df45f3aa3ccfafb64cf43bd03421.png) ![descript](media/3d37b1a85f2b578023fdcf88927ff655.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    | (N个样本)基于贝叶斯定理求后验概率                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 最大后验估计 ![descript](media/7156aecebfdfc3c609b7fac5f35fac0e.png) ![descript](media/6e818805a490ae7e6fbd13a93e9c886f.png)                                                                                                                | 令偏导数为0分别求解 ![descript](media/cc3cbc7ea1092a8ec685a353fe29f5e7.png) ![descript](media/458cbc47a2356f9723d1667427dc398c.png) |                                                                                                                |
| 朴素贝叶斯分类器                                                                 | 软二分类                                                                                                             | 0-1分类假设y服从伯努利分布 多分类假设y服从分类分布 ![descript](media/4996e7e69ba820308fe683ecb9b140c7.png) 若xj离散，xj服从分类分布 若xj连续，xj服从均值和方差都不同的高斯分布![descript](media/48d7dfc01ca7bfa3841867fdab610683.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | 朴素贝叶斯假设(条件独立性假设)：单个样本的P维特征相互独立                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | 最大后验估计                                                                                                                                                                                                                                | 令偏导数为0分别求解概率分布中的参数                                                                                                 | ![descript](media/fbc09aa5a2978aa6dbf809bd0520b2eb.jpg)                                                        |
| 硬间隔SVM                                                                        | 硬二分类                                                                                                             | ![descript](media/d699d4f5948d724b761b7357a998cfbd.png) ![descript](media/88e696bfb59087110325e878ff5ea0e3.png) ![descript](media/e4e354d314ef382b8402fdc3af3d9572.png) 寻找分类超平面                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 分类正确的前提下，令离超平面最近的点到超平面的距离最小                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | ![descript](media/7cb1e6471cc0e50a347c62ef2387f478.png) ![descript](media/8577f3dadd5dfe831ce89acdb6e3027e.png) ![descript](media/d23dc9baa02c0d4c93626ea4d6f41bf3.png) 为简化计算，可令最小间隔为1，其只是等比缩放值，并不改变超平面的方向 | 1.带约束优化问题转化为无约束优化问题，使用拉格朗日乘子法求解 转化为对偶问题求解 利用K-K-T条件求解                                   |                                                                                                                |
| 软间隔SVM                                                                        | 二分类                                                                                                               | 若分类正确损失值为0，若分类错误，损失值为1-间隔即合页损失 ![descript](media/fac86de8eaca09b9b43b458c10b250f1.png) ![descript](media/b7985408fa2d41d5cd98c56840339552.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | 允许在硬分类的基础上存在一小部分分类错误的样本                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | ![descript](media/05ab51f05aff159f48401be93b957171.png)                                                                                                                                                                                     | 1.转化为对偶问题求解 2.利用K-K-T条件求解                                                                                            |                                                                                                                |
| 高斯混合模型GMM                                                                  | 聚类                                                                                                                 | 建模数据分布P(x) 假设样本有K个聚类中心，则整体的概率分布为K个聚类中心高斯概率分布的叠加 ![descript](media/80c2ed29897b5811afebd176c1d0655a.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | 引入隐变量z,其分布表示样本x属于每个聚类中心的概率P z\~离散型随机变量 x\|z\~高斯概率分布                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               | ![descript](media/258b0e0a15dcdf04cc6ffa0d164167ff.png) ![descript](media/e5d72b885c30666f1e49552dcad77219.png) ![descript](media/a2a7ce1eadc948bc68e30965284b40c4.png) ![descript](media/5b50624365400769920b2eb95f787f12.png)             | 极大似然估计问题：log内部为连加项且高维高斯分布计算复杂，无法直接令导数为0求解析解 使用EM算法求解                                   | ![descript](media/097bc852da7d7c051573f36d3a616b4a.jpg)                                                        |
| 隐马尔可夫模型HMM                                                                |                                                                                                                      | 在HMM的基础上引入时间，建模时序序列 满足齐次马尔可夫假设：当前状态的概率只与前一状态有关![descript](media/427cf4b848b25183df8df580ef8d5046.png) 满足条件独立性假设：在给定隐变量z的前提下，所有观测变量x条件独立![descript](media/38593f4570a29461aa52fec66b107e58.png) model：![descript](media/021f9036b3235be8299a0330ebfc658e.png) ![descript](media/174db973d9cde324a533e198c5591052.png)为隐变量![descript](media/bd766d3178da534548adf9c3bf355b5b.png)(即t=1时刻)的概率分布，![descript](media/bd766d3178da534548adf9c3bf355b5b.png)\~**离散概率分布** **A**为不同时刻隐变量z的状态转移矩阵 ![descript](media/8e4c1f2c9ef68ae6f62ac87c28bf4e4d.png) **B**为当前时刻隐变量z和观测变量x之间的关系 ![descript](media/5b6cc9c803b9cd39baa134eefdeb30fd.png)  | 1、已知参数![descript](media/466025afca801423ba1f9922c6a4ec49.png)，求P(X\|![descript](media/466025afca801423ba1f9922c6a4ec49.png))【前向后向算法】 2、已知似然P(X\|![descript](media/466025afca801423ba1f9922c6a4ec49.png))，估计参数![descript](media/466025afca801423ba1f9922c6a4ec49.png)的值【EM算法】 3、已知观测序列![descript](media/4f983d1f54d85a12a21f60f5eb0d77bd.png)，求令P(Z\|X)最大的状态序列![descript](media/2626c518e898fc15b0510c3d6c7ff8b4.png) 预测即求![descript](media/cc47493e336711bc32d7a7a0d09325c1.png) 滤波即求 ![descript](media/d26848b7518e3c823d7ec05a78508214.png) |                                                                                                                                                                                                                                             |                                                                                                                                     | ![descript](media/c3ab961f0a22dafcd0c386ba6329502b.jpg)![descript](media/0878f389004e6e86446578adfd3e4618.jpg) |
| 卡尔曼滤波\\线性动态系统\\线性高斯模型                                           |                                                                                                                      | 隐变量和观测变量均连续且服从高斯分布 不同时刻的状态之间有线性关系 噪声服从高斯分布![descript](media/408182cc55d173bdfc4dbe3c60524538.png) ![descript](media/48c2a6e50ef225efd1f6a80183c6cb3f.png) 其余与HMM相同                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                             |                                                                                                                                     |                                                                                                                |
| 粒子滤波                                                                         |                                                                                                                      | 非线性，非高斯模型，需要通过采样近似的方式求解析解 其余与HMM相同                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                             |                                                                                                                                     |                                                                                                                |
| 最大熵模型（**打破条件独立性假设**）和条件随机场（**打破齐次一阶马尔可夫**假设） | ![descript](media/9e14d352cfaefe92167f5bb7d8512093.jpg)                                                              |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                             |                                                                                                                                     |                                                                                                                |
| 玻尔兹曼机BM                                                                     | 带隐节点的马尔可夫随机场（无向图） 概率密度函数为指数族分布                                                          |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                             |                                                                                                                                     |                                                                                                                |
| 受限玻尔兹曼机RBM                                                                | 限制BM仅在隐变量和观测变量之间存在连接（组内无关，组间相连） ![descript](media/0a1bfed1f42256e1bfc98b1ba6c6b701.png) |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |                                                                                                                                                                                                                                             |                                                                                                                                     |                                                                                                                |

## 补充：点到直线的距离公式：

-   距离公式：d=│（Ax₀+By₀+C）/√(A²+B²)│
-   公式描述：公式中的直线方程为Ax+By+C=0，点P的坐标为(X₀，Y₀)。点到直线的距离，即过这一点做目标直线的垂线，由这一点至垂足的距离。

## 主成分分析PCA

概念：将一组可能线性相关的变量通过正交变换变换为一组线性无关（相互正交）的变量，可通过求**最大化新方向上的投影方差**或**最小化重构距离（重后样本和原样本的l2距离）**两个角度实现

前q维主成分的计算方法

-   计算协方差矩阵，对**协方差矩阵进行特征值分解**后对应的**特征向量**的前q维
-   奇异值分解SVD角度：对**中心化(即样本-均值)后的数据执行奇异值分解**的到**特征向量**和特征矩阵
-   若**协方差矩阵为对称阵，则奇异值分解就是特征分解**

## 核技巧/核函数：

定义：能拆分为非线性转换内积的函数

作用：通过**直接求核函数值**可替代求**样本非线性转换函数内积**，从而简化计算

## 核方法：用于解决非线性可分问题

在基础模型中引入非线性转换处理原样本，再使用核技巧简化运算

## EM算法

应用场景：用于解决**具有隐变量的混合模型**的**极大似然估计问题**

![descript](media/2cbe829f865442e92d92f7fbe4d2a674.png)

迭代求解步骤：

输入：观测数据x，隐变量数据z，联合分布P(x,z) = pzN(x)，条件分布P(z\|x) { = P(x,z)/p(x)}

输出：模型参数![descript](media/441ca1bfae1d0daeb122def7c6134c8a.png)

（1）随机确定初始值![descript](media/763236ff17b126d66f7d1e1b3f054f0c.png)，开始迭代；

（2）E步：计算期望E表达式

（3）M步：令期望表达式最大得到![descript](media/9a7e4f1babf64ca6eb309cf690fd59f3.png)

（4）重复E步和M步直到收敛

## 谱聚类

Data：![descript](media/9330bb742a7a4e657d882c5804fee6c2.png)

将N个样本建模为带权重的无向图G={V,E}，V=X，E = W = [Wij]

W为**相似度矩阵**或**邻接矩阵![descript](media/2c9d7607da707475168ec0cb49208627.png)**

谱聚类基于图划分的思想实现，假设划分为k个类别，谱聚类目标=找到令类间相似度最小的划分序列![descript](media/f0db6acfcd20ae7fb226928f23162be8.png)【组合优化问题】

![descript](media/3d01da6c3a751774991ca94cee651b3e.png)

为消除划分中不同节点数量的影响，引入归一化因子

![descript](media/e8eff52ffe16a40a6081a04fbc6944e6.png), dig为集合Ak中所有每个节点权重和之和

